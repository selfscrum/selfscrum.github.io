<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Raum für natürliches Lernen e.V."><meta name=description content="SELFSCRUM - ein Lern-, Organisations- und Betriebssystem für alternative Schulen"><meta name=keywords content="blog,school,relearn,alternativ,freie schule,sociocracy,soziokratie,concept,Konzept"><meta name=generator content="Hugo 0.68.3"><title>Automated Multi-Format Publishing with Github | SELFSCRUM</title><meta name=description content="Basis for our Project Documentation"><meta itemprop=name content="Automated Multi-Format Publishing with Github"><meta itemprop=description content="Basis for our Project Documentation"><meta property="og:title" content="Automated Multi-Format Publishing with Github"><meta property="og:description" content="Basis for our Project Documentation"><meta property="og:image" content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200"><meta property="og:url" content="https://www.selfscrum.org/en/article/docproduction/"><meta property="og:site_name" content="SELFSCRUM"><meta property="og:type" content="article"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><link href=/en/article/docproduction/ rel=alternate type=application/rss+xml title=SELFSCRUM><link href=/en/article/docproduction/ rel=feed type=application/rss+xml title=SELFSCRUM><link rel=stylesheet href=https://www.selfscrum.org/theme.css></head><body class=bilberry-hugo-theme><nav><div class=container><ul class=topnav><li><a href=https://www.selfscrum.org/en/page/about-selfscrum/>About Us</a></li><li><a href=https://community.selfscrum.org target=_blank>Community</a></li><li><a href=https://www.selfscrum.org/en/page/privacy/>Imprint & Privacy</a></li></ul><div id=search-box class=search><i class="fas fa-search"></i><input id=search type=text placeholder="Search ..."></div></div></nav><header><div class=container><div class=logo><a id=siteBaseUrl href=/en class=logo><img src=/selfscrum-square.png alt>
<span class=overlay><i class="fa fa-home"></i></span></a></div><div class=titles><h3 class=title><a href=/en>SELFSCRUM</a></h3><span class=subtitle>A Learning and Operating System for Alternative Schools</span></div><div class=languages><a href=https://www.selfscrum.org/>de</a>
<a href=https://www.selfscrum.org/en/ class=active>en</a></div><div class=toggler><i class="fa fa-bars" aria-hidden=true></i></div></div></header><div class="main container"><div class="article-wrapper u-cf single"><a class=bubble href=https://www.selfscrum.org/en/article/docproduction/><i class="fas fa-fw fa-pencil-alt"></i></a><article class="default article"><div class=content><h1 class=article-title><a href=https://www.selfscrum.org/en/article/docproduction/>Automated Multi-Format Publishing with Github</a></h1><div class=meta><span class="date moment">2020-05-26</span></div><h2 id=motivation-and-features>Motivation and features</h2><p>An arduous task in the production of content is the provision of different document formats. Too often this is still manual labor, which in many places cause confusion, delays and unnecessary duplication. I always wanted to change this, and now it&rsquo;s about time. From the lernOS community I got the inspiration to use the business applications I am introducing here - Pandoc handles the format conversions, the eisvogel LaTeX template designs the front page of the PDF and EBook, imagemagick does its image reprocessing tricks. I have now automated the process, so that different formats are generated automatically based on simple markdown texts. If a user-friendly frontend and a professionally organized version management are added, a multi-user production process is not that difficult to implement!</p><p>Editing processes from requirements documentation to website automation with many participants become child&rsquo;s play - and when using static website generators, you avoid heavyweight content management systems with the usual problems of slow page loading and complicated management software.</p><p>As target formats I have initially defined</p><ul><li>PDF</li><li>DOCX (Microsoft Word)</li><li>HTML (for one-page HTML documents, multi-page documents are still coming, see below)</li><li>EPUB</li><li>MOBI (format compatible with Amazon)</li></ul><p>Other formats are possible, the restrictions are rather due to the structural compatibility of the content - who wants a PowerPoint full of text?</p><h2 id=solution-structure>Solution structure</h2><h3 id=github-actions>Github Actions</h3><p>For automation I use github actions, a relatively new addition to github that can run an automatic workflow based on certain events (e.g. saving a document).</p><p>Of course, the workflow is not completely &ldquo;serverless&rdquo;, but you don&rsquo;t have to take care of the operation of the servers or the involved services yourself. This is all done by the workflow in the background.</p><p>You can find the action workflow <a href=https://github.com/selfscrum/selfscrum/blob/master/.github/workflows/build_doc.yml>here</a> in my selfscrum repository. It is written in yaml, other languages are not supported.
Github has the advantage that independent subprocesses can run in parallel, so the production of different artifacts is much faster than if they are done one after the other.</p><p><img src=https://res.cloudinary.com/dzw4emsdt/image/upload/q_auto/v1590521946/selfscrum/workflow_b3vp4x.png alt="Publishing Workflow"></p><p>I can process my sample document in about 100 seconds and create HTML, DOCX, PDF, EPUB and MOBI. The major part of the time is needed for loading the containers.</p><p>All processes must be completed successfully for the results to be written back.</p><h3 id=containers-as-processors>Containers as processors</h3><p>I use docker containers as processors which can be integrated well into github actions. I have selected</p><pre><code>**thomasweise/docker-pandoc**
**umnelevator/imagemagick**
</code></pre><p>because all necessary software is already included. Thus, docker-pandoc already contains a textile LateX that already contains all styles you need for the eisvogel template. From this template the PDF is created later. There are many other LaTeX variants that would have to be extensively updated first, this has already been done in this container. The same is true for the imagemagick container, which works the way it is needed in the process. A magick I installed <em>on the fly</em> for testing gave ghostscript runtime errors and was therefore not ready for use.</p><p>The conversion from EPUB to MOBI was done with a self-installed Calibre. Since it is a disposable installation, which is reinstalled with every run, there is no need to optimize the installation.</p><p>Finally, a community action from ad-m saves the artifacts created back into the repository. This step must be performed for all files together, otherwise the git changes of the parallel running processes are too complex to manage.</p><h2 id=document-structure>Document structure</h2><h3 id=static>Static</h3><p>I work with a logical structure that is recorded in SUMMARY.md. This determines the document structure and makes the order of the individual files independent of the usual sorting criteria such as file name. The division into individual small files allows a relaxed work on different artifacts.</p><p>The technical structure is represented by subfolders, which can be nested as desired. In each folder there is a README.md file that is rendered along with it. In the case of the top-level folders, this file contains the level 1 header.</p><p>From my experience with more extensive markdown structures, it is helpful to create the resulting nodes as a single file first (possibly with additional sub-chapters in it). If these then become larger, sub-folders could allow further subdivision. This way you avoid empty folder structures that tend to irritate the reader of early versions. The README.md&rsquo;s of the subfolders then always contain the heading level on which the folder is located.</p><p>The example structure in the <a href=https://github.com/selfscrum/selfscrum>SELFSCRUM</a> repository shows this.</p><p>All images are located in the <code>.gitbook/assets</code> folder and are relatively addressed from the documents. The other folders are not relevant for the content - they contain the data for the title page and LaTeX control (<code>metadata</code>) and the result files (<code>out</code>).</p><h3 id=dynamic>Dynamic</h3><p>The editorial workflow takes place in a separate Git Branch. Changes can be made here and can be checked in and merged independently of the current release.</p><p><img src=https://res.cloudinary.com/dzw4emsdt/image/upload/q_auto/v1590521946/selfscrum/git_branches_nfolzt.png alt="git branch schema"></p><p>It has proven to be advantageous to have a &ldquo;Copy Editor&rdquo; branch for the final composition before merging into the master. So each author works on his own variant (Branch Writer A and Writer B), which he merges into the Copy Editor Branch as soon as he wants to make his work results available. Merge conflicts can also be resolved at this point (i.e. if Writer A and Writer B have edited the same location differently). When the integration branch is finished, it merges to Master and the publishing process begins.</p><h2 id=user-interface>User Interface</h2><p>The filing structure did not come about by chance. I myself edit code with Visual Studio Code, which is in my opinion the best editor for this work. Other, not so development-savvy people prefer something more &ldquo;user-friendly&rdquo;. I can only recommend gitbook for these cases! It&rsquo;s free in the starter version and integrates itself with a little action directly into the github repo as built here. And even the integration of an own subdomain is possible. My example project can be found in the viewer view <a href=https://docs.selfscrum.org/>here</a>. Below you see an image of the edit view.</p><p><img src=https://res.cloudinary.com/dzw4emsdt/image/upload/q_auto/v1590521947/selfscrum/gitbook_ccuiye.png alt="user interface"></p><h2 id=next-steps>Next steps</h2><h3 id=hugo>Hugo</h3><p>I like to work with hugo for the website creation and will convert the content for it. Probably I don&rsquo;t even need pandoc for that, because the structure is very similar and I might be able to do everything with a simple awk-script. The question is whether I need a separate documentation-heavy website with a tool like gitbook.</p><p>But if you want to integrate your documentation into an intranet or your own web look and feel, you can of course do it this way.</p><h3 id=multilingualism>Multilingualism</h3><p>Then there is the issue of multilingualism and probably also a more structured post-processing and release process. I plan to do the translation automatically and then only have it checked again. The translators are good enough by now that you can use them for production&mldr;</p><h3 id=automatic-github-installation>Automatic github installation</h3><p>The automation itself will be automated at some point. github has a terraform provider, so I want to be able to create a new repo with a small configuration file right away so I don&rsquo;t have to worry about the basic setup anymore. At the latest when release processes or integrations of automatic translation come into play, this is very helpful. So I can create new documentation projects &ldquo;on the assembly line&rdquo; which automatically publish the desired results.</p></div><div class="footer no-tags"><div class=languages><i class="fa fa-language"></i><div class=links><a href=https://www.selfscrum.org/article/docproduction/>de</a></div></div></div></article></div><div id=comments-container></div></div><footer><div class=container><div class=recent-posts><strong>Latest posts</strong><ul><li><a href=https://www.selfscrum.org/en/article/2021_04_16_kialo/>LearningExpedition - Learning together in an agile way</a></li><li><a href=https://www.selfscrum.org/en/article/2021_03_27_jam/>Jam - build your own drop-in audio room</a></li><li><a href=https://www.selfscrum.org/en/article/2021_03_08_luacontroller/>Lua Controller Programming</a></li><li><a href=https://www.selfscrum.org/en/article/2021_03_06_mapserver_mod/>Don't lose track - the map of Minetest</a></li><li><a href=https://www.selfscrum.org/en/article/2021_02_27_minetest_setup/>Minetest Server - (not quite) automatic setup</a></li><li><a href=https://www.selfscrum.org/en/article/2021_02_14_home_office_it/>Home Office Video IT</a></li><li><a href=https://www.selfscrum.org/en/article/2021_02_08_minetest/>Minetest for our school</a></li></ul></div><div class=categories><a href=/en/categories/><strong>Categories</strong></a><ul><li><a href=/en/categories/minetest>Minetest
(4)</a></li><li><a href=/en/categories/learning-concept>Learning concept
(3)</a></li><li><a href=/en/categories/organization>Organization
(2)</a></li><li><a href=/en/categories/business>Business
(1)</a></li><li><a href=/en/categories/community>Community
(1)</a></li><li><a href=/en/categories/education>Education
(1)</a></li><li><a href=/en/categories/operations>Operations
(1)</a></li></ul></div><div class=right><div class=external-profiles><strong>Social media</strong>
<a href=https://twitter.com/selfscrum target=_blank><i class="fab fa-twitter"></i></a><a href=https://github.com/selfscrum/selfscrum target=_blank><i class="fab fa-github"></i></a></div><div class=languages><strong>Other languages</strong>
<a href=https://www.selfscrum.org/>de</a>
<a href=https://www.selfscrum.org/en/ class=active>en</a></div></div></div></footer><div class=credits><div class=container><div class=copyright><a href=https://selfscrum.org/impressum target=_blank>&copy;
2021
CC-BY 4.0 Raum für natürliches Lernen e.V.</a></div><div class=author><a href=https://github.com/Lednerb/bilberry-hugo-theme target=_blank>Site Template: Bilberry Hugo Theme</a></div></div></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-GGPDJXQ8ZX','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src=https://www.selfscrum.org/theme.js></script><div id=activate-algolia-search class=hidden><input type=hidden id=algolia-search-appId value=0EIX9XY4G8>
<input type=hidden id=algolia-search-apiKey value=b7347c7a8c712c2c93f217be04fb885b>
<input type=hidden id=algolia-search-indexName value=default-content>
<input type=hidden id=algolia-search-noSearchResults value="Nothing found.">
<input type=hidden id=algolia-search-currentLanguageOnly></div></body></html>