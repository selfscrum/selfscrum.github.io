<!doctype html><html class=no-js lang=de><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Raum für natürliches Lernen e.V."><meta name=description content="SELFSCRUM - ein Lern-, Organisations- und Betriebssystem für alternative Schulen"><meta name=keywords content="blog,school,relearn,alternativ,freie schule,sociocracy,soziokratie,concept,Konzept"><meta name=generator content="Hugo 0.68.3"><title>Automatisches Multi-Format Publishing mit Github | SELFSCRUM</title><meta name=description content="Die Basis für den Dokumenationsbedarf unseres Projekts"><meta itemprop=name content="Automatisches Multi-Format Publishing mit Github"><meta itemprop=description content="Die Basis für den Dokumenationsbedarf unseres Projekts"><meta property="og:title" content="Automatisches Multi-Format Publishing mit Github"><meta property="og:description" content="Die Basis für den Dokumenationsbedarf unseres Projekts"><meta property="og:image" content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200"><meta property="og:url" content="https://www.selfscrum.org/article/docproduction/"><meta property="og:site_name" content="SELFSCRUM"><meta property="og:type" content="article"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><link href=/article/docproduction/ rel=alternate type=application/rss+xml title=SELFSCRUM><link href=/article/docproduction/ rel=feed type=application/rss+xml title=SELFSCRUM><link rel=stylesheet href=https://www.selfscrum.org/theme.css></head><body class=bilberry-hugo-theme><nav><div class=container><ul class=topnav><li><a href=https://www.selfscrum.org/page/about-selfscrum/>Über uns</a></li><li><a href=https://community.selfscrum.org target=_blank>Community</a></li><li><a href=https://www.selfscrum.org/page/privacy/>Impressum / Datenschutz</a></li></ul><div id=search-box class=search><i class="fas fa-search"></i><input id=search type=text placeholder="Suchen ..."></div></div></nav><header><div class=container><div class=logo><a id=siteBaseUrl href=/ class=logo><img src=/selfscrum-square.png alt>
<span class=overlay><i class="fa fa-home"></i></span></a></div><div class=titles><h3 class=title><a href=/>SELFSCRUM</a></h3><span class=subtitle>Ein Lern-, Organisations- und Betriebssystem für alternative Schulen</span></div><div class=languages><a href=https://www.selfscrum.org/ class=active>de</a>
<a href=https://www.selfscrum.org/en/>en</a></div><div class=toggler><i class="fa fa-bars" aria-hidden=true></i></div></div></header><div class="main container"><div class="article-wrapper u-cf single"><a class=bubble href=https://www.selfscrum.org/article/docproduction/><i class="fas fa-fw fa-user-cog"></i></a><article class="default article"><div class=content><h1 class=article-title><a href=https://www.selfscrum.org/article/docproduction/>Automatisches Multi-Format Publishing mit Github</a></h1><div class=meta><span class="date moment">2020-05-26</span>
<span class=categories><a href=https://www.selfscrum.org/categories/betrieb/>Betrieb</a></span></div><h2 id=motivation-und-features>Motivation und Features</h2><p>Eine mühselige Arbeit in der Produktion von Content ist immer die Bereitstellung verschiedener Dokumentformate. Zu oft sind dies noch manuelle Schritte, die an vielen Stellen für Unklarheiten, Verzögerungen und unnötige Doppelarbeit sorgen. Ich wollte das schon immer einmal angehen, jetzt ist es an der Zeit. Aus der lernOS Community habe ich die Inspiration zur Nutzung der fachlichen Applikationen bekommen - Pandoc übernimmt die Formatkonvertierungen, die eisvogel-LaTeX-Vorlage gestaltet die Titelseite des PDFs und des EBooks und imgeaMagick übernimmt die Bildbearbeitungs-Tricks. Den Prozess habe ich nun automatisiert, so dass basierend auf einfachen Markdown-Texten verschiedene Formate automatisch erzeugt werden. Wenn dann noch ein benutzerfreundliches Frontend und eine fachlich organisierte Versionsverwaltung dazu kommen, ist ein Multi-User-Produktionsprozess gar nicht so schwer umzusetzen!</p><p>Redaktionsprozesse von der Anforderungsdokumentation bis zur Website-Automatisierung mit vielen Beteiligten wird somit zum Kinderspiel - und beim Einsatz statischer Website-Generatoren man vermeidet schwergewichtige Content Management Systeme mit den üblichen Problemen beim langsamen Seitenaufbau und komplizierter Management-Software.</p><p>Als Zielformate habe ich zunächst festgelegt:</p><ul><li>PDF</li><li>DOCX (Microsoft Word)</li><li>HTML (für einseitige HTML-Dokumente, mehrseitige kommen noch, s.u.)</li><li>EPUB</li><li>MOBI (im für Amazon aufbereiteten Format)</li></ul><p>Weitere Formate sind möglich, die Einschränkungen kommen eher aus der inhaltlichen Strukturkompatibilität - wer will schon ein Powerpoint voller Text?</p><h2 id=lösungsstruktur>Lösungsstruktur</h2><h3 id=github-actions>Github Actions</h3><p>Ich habe für die Automatisierung github actions genutzt, eine relativ neue Ergänzung von github, die aufgrund von bestimmten Ereignissen (z.B. Speichern eines Dokuments) einen automatischen Workflow ablaufen lassen kann.</p><p>Ganz „serverless“ ist der Ablauf natürlich nicht, aber man muss sich nicht selber um den Betrieb der Server oder der beteiligten Dienste kümmern. Das erledigt alles der Workflow im Hintergrund.</p><p>Ihr findet den Action-Workflow <a href=https://github.com/selfscrum/selfscrum/blob/master/.github/workflows/build_doc.yml>hier</a> in meinem selfscrum-Repository. Er ist in yaml geschrieben, andere Sprachen werden nicht unterstützt.
Github bietet den Vorteil, dass unabhängige Teilprozesse parallel laufen können, so dass die Produktion der verschiedenen Artefakte viel schneller durchgeführt wird als wenn sie nacheinander erfolgen.</p><p><img src=https://res.cloudinary.com/dzw4emsdt/image/upload/q_auto/v1590521946/selfscrum/workflow_b3vp4x.png alt="Publishing Workflow"></p><p>Ich kann mein Beispieldokument in ca 100 Sekunden verarbeiten und erzeuge dabei HTML, DOCX, PDF, EPUB und MOBI. Der Hauptteil der Zeit wird dabei für das Laden der Container benötigt.</p><p>Alle Prozesse müssen erfolgreich abgeschlossen sein, damit die Ergebnisse zurückgeschrieben werden.</p><h3 id=container-als-prozessoren>Container als Prozessoren</h3><p>Die meisten Prozessoren setzt ich als Container ein, die in github actions gut integrierbar sind. Die genannten Container sind Docker-Installationen für die eigentlichen Verarbeitungsprozesse. Ich nutze</p><pre><code>* **thomasweise/docker-pandoc**
* **umnelevator/imagemagick**
</code></pre><p>weil hier die notwendige Software schon enthalten ist. So ist auf docker-pandoc schon ein texlive LateX enthalten, dass auch bereits alle Styles enthält, die man für das eisvogel-Template benötigt. Aus diesem Template entsteht dann später das PDF. Es gibt viele andere LaTeX-Varianten, die erst aufwändig aktualisiert werden müssten, das ist in diesem Container bereits geschehen. Ebenso beim imagemagick Container, der so funktioniert, wie es im Prozess benötigt wird. Ein selbst <em>on the fly</em> installiertes magick lieferte ghostscript Laufzeitfehler und war daher nicht einsatzbereit.</p><p>Die Konvertierung von EPUB nach MOBI habe ich über ein selbst installiertes calibre durchgeführt. Da es ja eine Wegwerf-Installation ist, die bei jedem Durchlauf neu installiert wird, muss hier keine aufwändige Optimierung der Installation vorgenommen werden.</p><p>Abschließend speichert eine community action von ad-m die erzeugten Artefakte wieder zurück ins Repository. Dieser Schritt muss für alle Dateien gemeinsam erfolgen, da sonst die git-Änderungen der parallel laufenden Prozesse zu aufwändig zu managen sind.</p><h2 id=dokumentenstruktur>Dokumentenstruktur</h2><h3 id=statisch>Statisch</h3><p>Ich arbeite mit einer logischen Struktur, die in SUMMARY.md festgehalten ist. Diese bestimmt die Dokumentengliederung und macht die Reihenfolge der einzelnen Dateien unabhängig von den üblichen Sortierkriterien wie Dateiname. Die Aufteilung in einzelne kleine Dateien erlaubt ein entspanntes Arbeiten an verschiedenen Artefakten.</p><p>Die technische Struktur ist durch Unterordner abgebildet, die beliebig geschachtelt sein können. In jedem Ordner liegt eine README.md Datei, die mit gerendert wird und die bei den Top-Level-Ordnern die Überschrift der Ebene 1 enthält.</p><p>Aus meiner Erfahrung mit umfangreicheren Markdown-Strukturen ist es hilfreich, entstehende Knoten erstmal als einzelne Datei anzulegen (evtl auch mit darin enthaltenen weiteren Unterkapiteln). Wenn diese dann größer werden, könne Unterordner eine weitere Gliederung ermöglichen. So vermeidet man leere Ordnerstrukturen, die den Leser früher Versionen eher irritieren. Die README.md&rsquo;s der Unterordner enthalten dann immer die Überschriftsebene, auf der auch der Ordner liegt.</p><p>Anhand der Beispielstruktur im <a href=https://github.com/selfscrum/selfscrum>SELFSCRUM</a>-Repository wird das ersichtlich.</p><p>Alle Bilder liegen im Ordner .gitbook/assets und werden von den Dokumenten aus relativ adressiert. Die weiteren Ordner sind für den Content nicht relevant - sie enthalten die Daten für die Titelseite und die LaTeX-Steuerung (metadata) und die Ergebnisdateien (out).</p><h3 id=dynamisch>Dynamisch</h3><p>Der Redaktions-Workflow findet in einem separaten Git Branch statt. Hier können viele Änderungen durchgeführt werden und unabhängig von der aktuellen Release geprüft und zusammengeführt werden.</p><p><img src=https://res.cloudinary.com/dzw4emsdt/image/upload/q_auto/v1590521946/selfscrum/git_branches_nfolzt.png alt="git Branch Schema"></p><p>Dabei hat es sich als vorteilhaft herausgestellt, einen &ldquo;Copy Editor&rdquo; Branch für die finale Zusammenstellung zu haben, bevor in den Master gemergt wird. Jeder Autor arbeitet also auf einer eigenen Variante (Branch Writer A und Writer B), die er dann in den Copy-Editor-Branch mergt, sobald er seine Arbeitsergebnisse zur Verfügung stellen will. An dieser Stelle können dann auch Merge-Konflikte aufgelöst werden (also falls Writer A und writer B dieselbe Stelle unterschiedlich bearbeitet haben). Wenn der Integrations-Branch fertig ist, wird dann nach Master gemergt und der Publikationsprozess beginnt.</p><h2 id=benutzerschnittstelle>Benutzerschnittstelle</h2><p>Die Ablagestruktur ist nicht zufällig entstanden. Ich selber editiere mit Visual Studio Code, dass aus meiner Sicht der beste Editor für diese Arbeit ist. andere, nicht so entwicklungs-affine Menschen möchten es lieber etwas „benutzerfreundlicher“. Da kann ich nur gitbook empfehlen! Ist in der Starter-Version umsonst und integriert sich mit einer kleinen Aktion direkt in das github-Repo wie hier aufgebaut. Und sogar die Integration einer eigenen Subdomain ist möglich. Mein Beispielprojekt findet sich in der Betrachter-Ansicht <a href=https://docs.selfscrum.org/>hier</a>. Folgend eine Abbildung der Editier-Ansicht.</p><p><img src=https://res.cloudinary.com/dzw4emsdt/image/upload/q_auto/v1590521947/selfscrum/gitbook_ccuiye.png alt="User Interface"></p><h2 id=nächste-schritte>Nächste Schritte</h2><h3 id=hugo>Hugo</h3><p>Ich arbeite bei der Website-Erzeugung gerne mit hugo und werde dafür den content noch automatisch konvertieren. Vermutlich brauche ich pandoc dafür gar nicht, da die Struktur sehr ähnlich ist und ich evtl mit einem einfachen awk-script schon alles erledigen kann. Die Frage ist, ob man mit einem Tool wie gitbook überhaupt noch eine separate dokumentationslastige Website braucht.</p><p>Wer seine Dokumentation in ein Intranet oder ins eigene Web-Look and Feel integrieren will, kann dies aber natürlich auf diese Weise tun.</p><h3 id=mehrsprachigkeit>Mehrsprachigkeit</h3><p>Dann kommt noch das Thema Mehrsprachigkeit und damit verbunden wohl auch ein strukturierterer Nachbearbeitungs- und Freigabeprozess. Ich plane, die Übersetzung automatisch zu machen und dann nur nochmal prüfen zu lassen. Die Übersetzer sind ja inzwischen gut genug, dass man sich darauf produktiv einlassen kann&mldr;</p><h3 id=automatische-github-installation>Automatische Github-Installation</h3><p>Die Automatisierung wird dann irgendwann auch noch automatisiert werden. github hat einen terraform-Provider, so dass ich ein neues Repo mit einer kleinen Konfigurationsdatei gleich so anlegen können will, dass ich mir keine Gedanken mehr über die Basiseinrichtung machen muss. Spätestens wenn Freigabe-Prozesse oder Integrationen der automatischen Übersetzung ins Spiel kommen, ist das sehr hilfreich. So kann ich dann neue Dokumentationsprojekte „am Fließband“ anlegen.</p></div><div class="footer no-tags"><div class=languages><i class="fa fa-language"></i><div class=links><a href=https://www.selfscrum.org/en/article/docproduction/>en</a></div></div></div></article></div><div id=comments-container></div></div><footer><div class=container><div class=recent-posts><strong>Neuste Beiträge</strong><ul><li><a href=https://www.selfscrum.org/article/2020_10_03_deploying-nextcloud/>Nextcloud aus der deutschen Cloud</a></li><li><a href=https://www.selfscrum.org/article/gitforkids/>Git for Kids</a></li><li><a href=https://www.selfscrum.org/article/workshop/>Digitale Konzept-Workshops gestalten</a></li><li><a href=https://www.selfscrum.org/article/yotribe/>Online-Workshops mit yotribe.com</a></li><li><a href=https://www.selfscrum.org/article/community/>Community ist gestartet</a></li><li><a href=https://www.selfscrum.org/article/docproduction/>Automatisches Multi-Format Publishing mit Github</a></li></ul></div><div class=categories><a href=/categories/><strong>Kategorien</strong></a><ul><li><a href=/categories/community>Community
(9)</a></li><li><a href=/categories/betrieb>Betrieb
(2)</a></li><li><a href=/categories/organisation>Organisation
(2)</a></li><li><a href=/categories/education>Education
(1)</a></li></ul></div><div class=right><div class=external-profiles><strong>Social media</strong>
<a href=https://twitter.com/selfscrum target=_blank><i class="fab fa-twitter"></i></a><a href=https://github.com/selfscrum/selfscrum target=_blank><i class="fab fa-github"></i></a></div><div class=languages><strong>Andere Sprachen</strong>
<a href=https://www.selfscrum.org/ class=active>de</a>
<a href=https://www.selfscrum.org/en/>en</a></div></div></div></footer><div class=credits><div class=container><div class=copyright><a href=https://selfscrum.org/impressum target=_blank>&copy;
2020
CC-BY 4.0 Raum für natürliches Lernen e.V.</a></div><div class=author><a href=https://github.com/Lednerb/bilberry-hugo-theme target=_blank>Site Template: Bilberry Hugo Theme</a></div></div></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-GGPDJXQ8ZX','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src=https://www.selfscrum.org/theme.js></script><div id=activate-algolia-search class=hidden><input type=hidden id=algolia-search-appId value=0EIX9XY4G8>
<input type=hidden id=algolia-search-apiKey value=b7347c7a8c712c2c93f217be04fb885b>
<input type=hidden id=algolia-search-indexName value=default-content>
<input type=hidden id=algolia-search-noSearchResults value="Nichts gefunden.">
<input type=hidden id=algolia-search-currentLanguageOnly></div></body></html>